Assuming unrestricted shared filesystem usage.
host: frigobar
Building DAG of jobs...
Your conda installation is not configured to use strict channel priorities. This is however important for having robust and correct environments (for details, see https://conda-forge.org/docs/user/tipsandtricks.html). Please consider to configure strict priorities by executing 'conda config --set channel_priority strict'.
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job stats:
job                        count
-----------------------  -------
all                            1
blast_to_abc                   1
blastn_dotplot_unmapped        1
block_extension                1
check_GC                       1
clean_n_filter                 1
decont_stats                   1
define_blocks                  1
discard_contamination          1
discard_str                    1
find_str                       1
join_cont_refs                 1
make_seeds                     1
map_contamination              1
mcl_clustering                 1
total                         15

Select jobs to execute...
Execute 2 jobs...

[Wed Feb 11 10:25:54 2026]
Job 1: 
        Filtering reads by:
          - mean base quality (FASTQ only)
          - minimum length
        Generating length histograms before and after filtering.
        
Reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/clean_n_filter/reads.size_filtered.fasta

Activating conda environment: .snakemake/conda/618bc019cd454a9a0106a1e71d5c12ba_

[Wed Feb 11 10:25:54 2026]
Job 2: 
        Joins all fastq files from cont_reference.folder into a single file
        
Reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/join_cont_refs/join_crefs.fastq

[Wed Feb 11 10:29:52 2026]
Finished job 2.
1 of 15 steps (7%) done
[Wed Feb 11 10:34:48 2026]
Finished job 1.
2 of 15 steps (13%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 10:34:48 2026]
Job 3: 
        Maps the query fasta against the reference genomes from different contamintan organisms
        
Reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/map_contamination/query_x_ref-contamination.paf; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/join_cont_refs/join_crefs.fastq, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/clean_n_filter/reads.size_filtered.fasta

[M::mm_idx_gen::527.287*1.39] collected minimizers
[M::mm_idx_gen::594.161*2.05] sorted minimizers
[M::main::594.162*2.05] loaded/built the index for 8862 target sequence(s)
[M::mm_mapopt_update::618.689*2.01] mid_occ = 1394
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 8862
[M::mm_idx_stat::631.519*1.99] distinct minimizers: 141722133 (29.11% are singletons); average occurrences: 10.529; average spacing: 5.367; total length: 8008774714
[M::worker_pipeline::708.951*3.75] mapped 66415 sequences
[M::worker_pipeline::829.697*6.05] mapped 43578 sequences
[M::mm_idx_gen::993.058*5.24] collected minimizers
[M::mm_idx_gen::995.668*5.26] sorted minimizers
[M::main::995.670*5.26] loaded/built the index for 734 target sequence(s)
[M::mm_mapopt_update::995.671*5.26] mid_occ = 1394
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 734
[M::mm_idx_stat::999.943*5.24] distinct minimizers: 65412960 (54.56% are singletons); average occurrences: 2.977; average spacing: 5.760; total length: 1121802916
[M::worker_pipeline::1150.853*7.01] mapped 66415 sequences
[M::worker_pipeline::1277.074*8.26] mapped 43578 sequences
[M::main] Version: 2.28-r1209
[M::main] CMD: minimap2 -x map-ont -c --secondary=no -t 30 -o /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/map_contamination/query_x_ref-contamination.paf /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/join_cont_refs/join_crefs.fastq /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/clean_n_filter/reads.size_filtered.fasta
[M::main] Real time: 1283.193 sec; CPU: 10558.727 sec; Peak RSS: 28.404 GB
[Wed Feb 11 10:56:21 2026]
Finished job 3.
3 of 15 steps (20%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 10:56:21 2026]
Job 4: 
        Given a PAF alignment table, discard sequences from the filtered FASTA
        that have a "good" mapping against any contamination references, based on:
          - min alignment length
          - max de
          - min query coverage
        
Reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/decontamination/decont.fasta; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/map_contamination/query_x_ref-contamination.paf, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/clean_n_filter/reads.size_filtered.fasta

[Wed Feb 11 10:57:08 2026]
Finished job 4.
4 of 15 steps (27%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 10:57:08 2026]
localrule check_GC:
    input: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/decontamination/decont.fasta
    output: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/input_gc_table.txt, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.high_gc.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/gc_stats.tsv
    jobid: 5
    reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/decontamination/decont.fasta
    resources: tmpdir=/home/jpereira/tmp

[INFO][0m 1342 patterns loaded from file
[INFO][0m 4057 patterns loaded from file
[Wed Feb 11 10:57:13 2026]
Finished job 5.
5 of 15 steps (33%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 10:57:13 2026]
localrule find_str:
    input: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta, /home/jpereira/OEs/OE1.v2/Scripts/trf
    output: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/short_tandem_repeats.tsv
    jobid: 6
    reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/short_tandem_repeats.tsv; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta
    resources: tmpdir=/home/jpereira/tmp

[Wed Feb 11 11:00:47 2026]
Finished job 6.
6 of 15 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 11:00:47 2026]
localrule discard_str:
    input: /home/jpereira/OEs/OE1.v2/Scripts/discard_str.py, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/short_tandem_repeats.tsv
    output: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/sequences_wo_str.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/short_tandem_repeats.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/repeats.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/filtered_str.tsv
    jobid: 7
    reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/sequences_wo_str.fasta; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/check_gc/decont.low_gc.fasta, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/short_tandem_repeats.tsv
    resources: tmpdir=/home/jpereira/tmp

[Wed Feb 11 11:00:54 2026]
Finished job 7.
7 of 15 steps (47%) done
Select jobs to execute...
Execute 1 jobs...

[Wed Feb 11 11:00:54 2026]
localrule blast_to_abc:
    input: /home/jpereira/OEs/OE1.v2/Scripts/blast_to_abc.py, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/sequences_wo_str.fasta
    output: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/blast_to_abc/blastn.seqs_wo_str.inner.tsv, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/blast_to_abc/blast_map.abc, /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/blast_to_abc/uninformative_sequences.fasta
    jobid: 8
    reason: Missing output files: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/blast_to_abc/blast_map.abc; Input files updated by another job: /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/sequences_wo_str.fasta
    threads: 40
    resources: tmpdir=/home/jpereira/tmp



Building a new DB, current time: 02/11/2026 11:01:01
New DB name:   /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/blast_to_abc/decont_inner_db/sequences_wo_str.fasta
New DB title:  /home/jpereira/OEs/Results/OE1/TgUru2.2/Data/short_tandem_repeats/sequences_wo_str.fasta
Sequence type: Nucleotide
Keep MBits: T
Maximum file size: 3000000000B
Adding sequences from FASTA; added 1342 sequences in 0.578274 seconds.


